---
title: התמרת פורייה ההפוכה
author: אופיר דוד
category: התמרות פורייה
layout: post
dir: rtl
cssclasses:
  - hebrew
---
# איך מוצאים את ההתמרה ההפוכה

כאשר למדנו על טורי פורייה, התחלנו עם פונקציה מחזורית על $f:[-\pi,\pi]\to \RR$ , חישבנו ממנה את מקדמי פורייה $a_n,b_n$ והדרך העיקרית להבין בעזרתם את הפונקציה הקבועה הייתה להרכיב חזרה אתה פונקציה , כלומר 
$$.f(x) \sim \frac{a_0}{2} + \sum_{n=1}^\infty \left(a_n \cos(nx)+b_n \sin(nx)\right)$$
זה כמובן נבע מתכונות של בסיס אורתונורמלי, כי אם נסמן
$$,\{v_1,v_2,v_3,...\}=\{ \frac{1}{\sqrt{2}}\}\cup \{\cos(nx),\sin(nx)\;\mid\; n\in \NN\}$$אז מה שרשום למעלה זה בעצם $f\sim \sum _1^\infty \angles{f,v_k}\cdot v_k$.

היינו רוצים לעשות דבר דומה גם בהתמרת פורייה. הפעם ה"מקדמים" שלנו הם $\hat{f}(\omega)=\angles{f,e^{i\omega x}}$ והם מוגדרים לכל $\omega$. אם זה היה דומה לפונקציות המחזוריות, אז היינו מחפשים משהו בסגנון $\sum_\omega \hat{f}(\omega) e^{i\omega x}$ , אבל בגלל שהמקדמים הם לא דיסקרטים, אז נצטרך להסתכל על אינטגרל. תחת ההנחה שמותר לנו לעשות את כל המעברים הבאים, נקבל ש
$$\align{f(x_0)&\overset{?}{=}\int_{-\infty}^\infty \hat{f}(\omega)e^{i\omega x_0}\dom=\frac{1}{2\pi}\int_{-\infty}^\infty \int_{-\infty}^\infty f(x)e^{-i \omega x}e^{i\omega x_0}\dx \dom \\& 
=\frac{1}{2\pi} \int_{-\infty}^\infty  f(x) \left(\int_{-\infty}^\infty e^{i\omega (x_0-x)} \dom\right) \dx }$$
יש שני דברים מוזרים בחישוב הזה:
1. הפונקציה $\omega\mapsto e^{i\omega(x_0-x)}$ היא לא אינטגרבילית בהחלט על כל השיר, כי בערך מוחלט היא שווה ל 1.
2. יותר מכך, אפילו אם היה לה אינטגרל, שנסמן ב $g(t,x)$, איזה פונקציה זו אמורה להיות כדי ש $$?\;\;\;f(x_0)\overset{?}{=}\frac{1}{2\pi}\int_{-\infty}^\infty f(x)g(x_0,x)\dx$$
	נזכיר שאם נשנה פונקציה בנקודה אחת, האינטגרל שלה לא ישתנה, כלומר אם נשנה את הערך $f(x_0)$ בנקודה אחת $x_0$ אז אגף ימין לא ישתנה, בעוד שאגף שמאל ישתנה.

למרות שתי הבעיות האלו, עדיין אפשר "להגדיר" את ההתמרה ההפוכה, ולמרות שלא נכנס לכל ההוכחה המתמטית, בואו ננסה להבין קצת מאיפה היא מגיעה.

נתחיל קודם עם הבעיה השנייה. למרות שאין אינטגרל שמקיים את המעבר הזה, יש פונקציה מאוד פשוטה שמתחילה עם $f$ ומסיימת עם $f(x_0)$ שהיא פשוט ההצבה בנקודה $x_0$ ונסמן אותה ב
$$. \;\; \delta_{x_0}(f):=f(x_0)$$
נשים לב תחילה שזו פונקציה מהצורה $\delta_{x_0} : E^1(\RR)\to \RR$ בדיוק כמו פונקציית האינטגרל (כלומר היא לוקחת פונקציה ומחזירה סקלר) ובנוסף כמו האינטגרל זוהי פונקציה לינארית, כי לפי ההגדרה:
$$.\;\;\delta_{x_0}(\alpha f_1 + f_2) = \alpha f_1(x_0) + f_2(x_0) = \alpha \delta_{x_0}(f_1)+\delta_{x_0}(f_2)$$

אמנם אי אפשר להגדיר אותה ע"י רק אינטגרל, אבל האם ניתן לקרב אותה ע"י אינטגרל? אם הפונקציה $f$ היא רציפה, אז כן!

למשל, אם ניקח את הפונקציות:
$$\sigma_{h,x_0}(x):=\frac{2}{h}\cdot \chi_{[x_0-h,x_0+h]}(x)=\cases{\frac{2}{h} & |x-x_0|\leq h\\ 0 & else}$$
אז נקבל ש
$$\int_{-\infty}^{\infty}f(x)\sigma_{h,x_0}(x)\dx = \frac{2}{h} \int_{x_0-h}^{x_0+h}f(x)\dx\overset{h\to 0}{\longrightarrow} f(x_0)$$

במילים אחרות, פונקצית ההצבה שלנו היא גבול של פונקציות שמבוטאות באמצעות אינטגרלים. 

זה גם מסביר קצת את הבעיה הראשונה. במקום לחשוב על 
$$x\mapsto\int_{-\infty}^\infty e^{i\omega (x_0-x)} \dom$$
כפונקציה במשתנה $x$ שלא מוגדרת היטב כי האינטגרל לא מוגדר היטב, צריך לחשוב עליה כגבול של פונקציות (שיקבע לפי גבולות האינטגרציה כמו שנראה למטה) ואז פתאום נקבל את ההתמרה ההפוכה:
$$.\align{f(x_0)=\frac{1}{2\pi} \int_{-\infty}^\infty  f(x) \left(\int_{-\infty}^\infty e^{i\omega (x_0-x)} \dom\right) \dx }$$

---
# פונקצית דלתא של דירק

עם האינטואיציה מלמעלה, נגדיר את פונקציית דלתא של דירק, עם אותו סימון כמו פונקציית דלתא למעלה:

> [!הגדרה] סימון: פונקציית דלתא של דירק
> נסמן $\delta_a:\RR \to \RR$ להיות ה"פונקציה" שמקיימת
> $$f(a)=\int_I f(t)\delta_a(t)\dt $$
> עבור כל פונקציה רציפה ב $a$ וקבוצה $I$ שמכילה את $a$ כנקודה פנימית.
> כאשר $a=0$ נסמן פשוט $\delta(t):=\delta_0(t)$.

> [!הערה] הערה:
> בדרך כלל הקבוצה $I$ הולכת להיות כל הישר, אך כמובן שהפונקציה תלויה רק האיך ש $f$ מתנהגת באזור הנקודה $a$.

שימו לב שכמו שאמרנו למעלה, זהו סימון ואנחנו לא באמת מבצעים אינטגרציה במובן הרגיל. מה שכן, בגלל שפונקציית ההשמה $f\mapsto f(a)$ מקיימת תכונות דומות לפונקצית האינטגרל, אז זהו סימון נוח. באופן רשמי פונקציה כזאת נקראת **פונקציונלי**. בפרט "נניח" שאפשר לבצע החלפת משתנים, ואז נקבל ש

> [!טענה] הזזה של פונקציית דיראק
> מתקיים:
> $$f(a+b)=\int_{-\infty}^{\infty} f(t)\delta_a(t-b)\dt $$
> ובפרט:
> $$f(b)=\int_{-\infty}^{\infty} f(t)\delta(t-b)\dt $$

> [!הוכחה]- הוכחה:
> אם נרשה החלפת משתנים $s=t-b$ אז נקבל ש 
> $$.\int_{-\infty}^{\infty} f(t)\delta_a(t-b)\dt=\int_{-\infty}^{\infty} f(s+b)\delta_a(s)\dt=f(a+b)$$


> [!הגדרה] סימון: התכנסות לפונקציית דלתא
> כאשר נסמן התכנסות של פונקציות $g_n(x)\to\delta_a(x)$ לפונקציית דירק, הכוונה היא ש
> $$\int_{-\infty}^{\infty}f(x)g_n(x)\dx \to f(a)$$
> לכל פונקציה $f\in E^1(\RR)$ רציפה בנקודה $a$.
> 

תחת הסימון הזה, בעצם בחלק הקודם הראנו ש $\sigma_{h,a}\to\delta_a$ כאשר $h\to 0$. נשים לב שגם אם נחשוב על פונקציית דירק כגבול של אינטגרלים, אז לא מפתיע שהיא מקיימת תכונות כמו אינטגרציה ובפרט השימוש בהחלפת משתנים כמו שראינו למעלה.

כדי להראות שתוצאה דומה נכונה עבור פונקציות האקספוננטים שלנו נציין תחילה טענה ללא הוכחה. עוד מעט נוכיח משהו יותר חזק, כרגע זה רק לשם האינטואיציה.

> [!טענה] טענה:
> מתקיים ש $\displaystyle{\lim_{M\to\infty}} \frac{\sin(Mx)}{\pi x} = \delta(x)$.


באמצעות הטענה הזאת נוכל עכשיו להראות ש:
> [!טענה] גבול של אקספוננטים הוא דירק:
> לכל $a\in\RR$ מתקיים ש 
> $$\limfi{N} \frac{1}{2\pi} \int_{N}^{N} e^{i\omega(t-a)}\dom \to \delta_a(t)$$

> [!הוכחה]- הוכחה:
> בגלל שהראנו שאפשר להזיז את פונקציית דירק, כלומר $\delta_a(t)=\delta(t-a)$ אז נוכל לסמן $T=t-a$ ולהראות שהגבול הוא $\delta(T)$. עתה נקבל:
> $$\frac{1}{2\pi} \int_{-N}^{N} e^{i\omega T}\dom = \frac{1}{2\pi}\left( \int_{-N}^{N} \cos(\omega T)\dom + \int_{-N}^{N} i\sin(\omega T)\dom\right)$$
> פונקציה הסינוס היא אי זוגית, ולכן האינטגרל שלה מתאפס, וסה"כ נשאר עם  
> $$\frac{1}{2\pi} \int_{-N}^{N} e^{i\omega T}\dom = \frac{1}{2\pi} \frac{\sin(\omega T)}{T}\mid_{-N}^N =  \frac{\sin(N T)}{\pi T}$$
> והתוצאה נובעת מהטענה הקודמת.

עכשיו נוכל לחזור לטיעון שלנו בראש הדף בשביל לקבל שקיימת לנו התמרה הפוכה שמקיימת
$$\align{f(x_0) & 
=\frac{1}{2\pi} \int_{-\infty}^\infty  f(x) \left(\int_{-\infty}^\infty e^{i\omega (x_0-x)} \dom\right) \dx }$$

בנקודות רציפות של $f$.

---
# פונקצית דלתא באי רציפות

 מאחר והפונקציות שלנו באופן כללי הן לא רציפות, אז הטענה מלמעלה (שלא הוכחה לחלוטין) לא תעזור ועדיין נרצה לדעת מה קורה בנקודות אי רציפות.
 כדי לקבל קצת אינטואיציה בואו נסתכל על דוגמאות פשוטות וננסה להבין מה קורה שם, כאשר נשים דגש על הנקודה בראשית, כלומר אנחנו רוצים להבין את 
 $$.\int_{-\infty}^\infty f(x)\frac{\sin(Mx)}{\pi x} \dx$$
## פונקציות מציינות

אם נסתכל על הפונקציה $f(x)=\chi_{[a,b]}(x)$ אז נקבל את האינטגרל
$$\int_{a}^b \frac{\sin(Mx)}{\pi x} \dx = \int_{Ma}^{Mb} \frac{\sin(x)}{\pi x} \dx$$
הראו כתרגיל שהאינטגרל $\int_0^\infty \frac{\sin(x)}{x}\dx$ מתכנס. מסתבר שגם אפשר לחשב את האינטגרל הזה (למשל עם כלים מפונקציות מרוכבות) ולהראות שהוא שווה ל $\frac{\pi}{2}$. אם אנחנו מאמינים לזה, אבל הגבול כאשר $M\to \infty$ למעלה תלוי באיפה נמצאת הראשית יחסית לקטע $(a,b)$: 
$$\limfi{M} \int_{a}^b \frac{\sin(Mx)}{\pi x} \dx = \cases{1 & a<0<b \\ \frac{1}{2} & 0=a<b\text{  or  } a<b=0 \\ 0 & else}$$

נשים לב שאם הפונקציה היא רציפה בראשית, כלומר $a<0<b$ או $0\notin [a,b]$ אז באמת קיבלנו שהגבול של האינטגרל הוא הערך הראשית. אחרת, קיבלנו $\frac{1}{2}$ שהוא "ממוצע" הערכים, כלומר
$$.\frac{f(0^-)+f(0^+)}{2}$$
## הפונקציה הלא רציפה הכי פשוטה
מתחיל עם הפונקציה 
$$.f(x)=\cases{\frac{1}{1+x^2}&x\geq 0 \\ \frac{-1}{1+x^2} & x<0}$$
זוהי כמובן פונקציה רציפה פרט לראשית, ובחרנו אותה כך שהאינטגרל שלה יתכנס, כלומר $f\in E^1(\RR)$. בנוסף זוהי פונקציה אי זוגית, ולכן האינטגרל
$$.\int_{-\infty}^\infty f(x) \frac{\sin(Mx)}{\pi x}\dx = 0$$
כמובן, שעבור פונקציות אי זוגיות, הממוצע של הגבולות בראשית (בהנחה והם קיימים) גם חייב להיות אפס.

## שינוי רחוק מהראשית
מה יקרה אם נשנה אותה רחוק מהראשית, נניח בתחום $[100,200]$? אם נסמן את הפונקציה החדשה ב $\tilde{f}(x)$ אז נקבל ש 
$$\align{\int_{-\infty}^\infty \tilde{f}(x) \frac{\sin(Mx)}{\pi x}\dx & = \overbrace{\int_{-\infty}^\infty f(x) \frac{\sin(Mx)}{\pi x}\dx}^{=0} + \int_{100}^{200} (\tilde{f}(x)-f(x)) \frac{\sin(Mx)}{\pi x}\dx \\
& = \int_{100}^{200} \frac{\tilde{f}(x)-f(x)}{\pi x} \sin(Mx)\dx }$$
בתחום $[100,200]$ הפונקציה $g(x)=\frac{\tilde{f}(x)-f(x)}{\pi x}$ היא תחילה הפרש של שתי פונקציה ב $E^1(\RR)$ ולכן היא גם שם, וחילקנו ב $x$ , שלא יוצר בעיות כי אנחנו לא ליד האפס. עכשיו נשארנו עם הגבול של האינטגרל 
$$\limfi{M}\int_{100}^{200} g(x) \sin(Mx) \dx$$
אבל ראינו שאינטגרל כזה שואף לאפס, כי זו בדיוק הלמה של רימן לבג. אפילו לא היינו צריכים לעצור ב 200, ויכולנו לעשות אינטגרל עד אינסוף, ואותו הדבר בחלק השלילי. במילים אחרות, הגבול של האינטגרל כולו תלוי רק באיך ש $f$ נראית מאוד קרוב לראשית!

כרגע לפחות אנחנו יודעים שהאינטגרל הוא אפס אם הפונקציה שלנו אי זוגית + שינויים "הרחק" מהראשית, כלומר היא "אי זוגית רק בסביבת הראשית". זה כמובן גורר שסכום הגבולות מימין ומשמאל הראשית (אם קיימים) הוא עדיין אפס.

## מה קורה בראשית?

אזור הראשית הוא יותר בעייתי, כי אי אפשר פשוט לעשות את ה"מעבר":
$$ f(x)\cdot \frac{\sin(Mx)}{\pi x} = \frac{f(x)}{\pi x} \cdot \sin(Mx)$$
ולהשתמש ברימן לבג, כי באופן כללי הפונקציה $\frac{f(x)}{x}$ היא כבר לא צריכה להיות עם אינטגרל סופי. מצד שני, לפונקציה $\frac{\sin(Mx)}{\pi x}$ כן יש גבול בראשית, ולכן אם במקרה $f(x)$ הייתה קבועה מימין לראשית, נניח ב $(0,\varepsilon)$ אז נוכל ממש לחשב שם את האינטגרל (זה היה החישוב הראשון שלנו עם פונקציות מציינות). אם היא לא קבועה, אז בתקווה יש לנו את הדבר הכי טוב הבא בתור, ויש לה שם גבול שנסמן ב $f(0^+)$ ואז נקבל ש 
$$\align{\int_0^\varepsilon f(x)\cdot \frac{\sin(Mx)}{\pi x} \dx & = \int_0^\varepsilon \left(f(x)-f(0^+)+f(0^+)\right)\cdot \frac{\sin(Mx)}{\pi x} \dx \\
& \int_0^\varepsilon \left[\frac{f(x)-f(0^+)}{x}\cdot\frac{\sin(Mx)}{\pi} +f(0^+)\cdot \frac{\sin(Mx)}{\pi x}\right] \dx} $$
כמו שכבר אמרנו, למחובר השני אנחנו ממש יכולים לחשב את האינטגרל. במחובר הראשון עדיין יש בעיה, אבל אם $\frac{f(x)-f(0^+)}{x}$ פונקציה מספיק יפה, למשל יש לה גבול בראשית, אז שוב נוכל להשתמש בלמה של רימן לבג. אבל בעצם כבר ראינו את הביטויים האלו - להגיד שיש גבול בראשית בדיוק שקול לכך שיש נגזרת מתואמת מצד ימין.

---
# התמרת פורייה ההפוכה

עכשיו אפשר לחבר את כל החלקים כדי לקבל את התוצאה הבאה:

> [!משפט] התמרת פורייה ההפוכה
> תהא $f\in E^1(\RR)$. בכל נקודה $x_0\in \RR$ בה יש לפונקציה נגזרות מתואמות, מתקיים ש
> $$\limfi{M} \int_{-M}^M \hat{f}(\omega)e^{i\omega x_0}\dom = \frac{f(x_0^-)+f(x_0^+)}{2}$$ 

> [!הוכחה]- הוכחה:
> כרגיל, כדאי להתחיל עם פישוט הבעיה, למשל נרצה לעבור מ $x_0$ כללי לראשית. לשם כך נגדיר את $g(x)=f(x_0+x)$ ואז נקבל ש $\hat{g}(\omega)=\hat{f}(\omega)e^{i\omega x_0}$ 
> בסימון החדש הזה מספיק להראות ש 
> $$\align{\frac{g(0^-)+g(0^+)}{2}& \overset{?}{=}\limfi{M} \int_{-M}^M \hat{g}(\omega)\dom = \frac{1}{2\pi}\limfi{M}  \int_{-\infty}^{\infty} g(x)\int_{-M}^M e^{-i\omega x}  \dom \dx \\ &  = \limfi{M}  \int_{-\infty}^{\infty} g(x) \frac{\sin(Mx)}{\pi x} \dx}$$ 
> נחשב את האינטגרל על החלק החיובי של ציר ה $x$. כמו מקודם נכתוב $g(x)=g(x)-g(0^+)-g(0^+)$ ואז האינטגרל למעלה (ללא הגבול) יהיה:
> $$\int_{0}^{\infty} \frac{g(x)-g(0^+)}{\pi x} \sin(Mx) \dx+g(0^+)\int_{0}^{\infty} \frac{\sin(Mx)}{\pi x} \dx$$
> כבר ראינו שהאינטגרל השני שואף ל $\frac{1}{2}$ כאשר $M\to \infty$. עבור הפונקציה $\frac{g(x)-g(0^+)}{\pi x}$ היא ב $E^1(\RR)$ כי $g(x)\in E^1(\RR)$ ולא הוספנו בעיה בראשית בחלוקה ב $x$ בגלל הנגזרת המתואמת.
> עכשיו אפשר להשתמש בלמה של רימן לבג על האינטגרל הראשון כדי לקבל שהגבול הוא אפס, ולכן סה"כ קיבלנו שהגבול הוא $\frac{g(0^+)}{2}$. חישוב דומה נעשה בחלק השלילי של ציר האיקס ויחד איתו מקבלים את התוצאה שרצינו.


> [!מסקנה] התמרה כפולה היא (כמעט) הזהות
> אם $f,\hat{f}\in E^1(\RR)$  ול $f$ יש נגזרות מתואמות ב $x_0$ אז מתקיים ש 
> $$\hat{\hat{f}}(x_0) = \frac{1}{2\pi} \frac{f(-x_0^+)+f(-x_0^-)}{2}$$
> ובפרט אם $f$ רציפה ב $x_0$ אז מתקיים ש 
> $$\hat{\hat{f}}(x_0) = \frac{1}{2\pi} f(-x_0)$$

> [!הוכחה]- הוכחה:
> נשים לב תחילה שתחת ההנחה ש $f,\hat{f} \in E^1(\RR)$ הביטוי $\hat{\hat{f}}(x)$ מוגדר היטב. בפרט, בגלל ש $\hat{f}\in E^1(\RR)$ הקצב שאיפה ל $\pm \infty$ באינטגרל לא משנה, ולכן
> $$\align{\hat{\hat{f}}(x_0) & = \frac{1}{2\pi}\int_{-\infty}^\infty \hat{f}(\omega) e^{-i\omega x_0} \dom = \frac{1}{2\pi}\limfi{M}\int_{-M}^M \hat{f}(\omega) e^{i\omega (-x_0)} \dom \\ &= \frac{1}{2\pi} \frac{f(-x_0^+)+f(-x_0^-)}{2}}$$

נזכיר שהראנו שאם $f\in E^1(\RR)$ ולכן יש לה התמרת פורייה, אז  $\norm {\hat{f}}_\infty \leq \frac{1}{2\pi} \norm f_1$ . עכשיו שיש לנו את ההתמרה ההפוכה בעצם גם נקבל ש 

> [!מסקנה] מסקנה:
> אם $f,\hat{f} \in E^1(\RR)$ ו $f$ רציפה עם נגזרות מתואמות, אז $f$ חסומה ומתקיים ש 
> $$.\norm f_\infty \leq \norm {\hat{f}}_1$$

---
## דוגמאות

> [!דוגמא] דוגמא: הפונקציה $e^{-\abs{x}}$
> כבר ראינו ש $\cf\left[e^{\abs{x}}\right] = \frac{1}{\pi (\omega^2+1)}$. מאחר ושתי הפונקציות $e^{-\abs{x}}, \frac{1}{\pi (\omega^2+1)}\in E^1(\RR)$, הן גזירות ברציפות בכל מקום פרט לראשית, אבל שם יש גזירות מתואמות, אז ממשפט ההתמרה ההפוכה נקבל ש 
> $$.e^{-\abs{x}}=\int_{-\infty}^\infty \frac{1}{\pi (\omega^2+1)} e^{i \omega x} \dom$$
> שימו לב שביטלנו את החלוקה ב $2\pi$ בשני האגפים, ולא צריך לקחת $-x$ באגף שמאל, כי הוא גם ככה מופיע בערך מוחלט.
> נוכל עכשיו להשתמש בזהות אוילר $e^{i \omega x} = \cos(\omega x)+i\sin(\omega x)$ יחד עם העובדה שהפונקציה $\frac{1}{\pi (\omega^2+1)}$ היא ממשית וזוגית, כדי להסיק ש:
> $$.e^{-\abs{x}}=\int_{-\infty}^\infty \frac{\cos(\omega x)}{\pi (\omega^2+1)} \dom$$

> [!דוגמא] דוגמא: הפונקציה המציינת $\chi_{[-a,a]}$
> ראינו ש $\cf[\chi_{[-a,a]}](\omega) = \frac{\sin(\omega a)}{\omega \pi}$. הפונקציה הזאת היא בעצם הפונקציה שהשתמשנו כדי להוכיח את קיום ההתמרה ההפוכה! כלומר, כאשר $a\to \infty$ ההתמרה של הפונקציה שואפת לפונקציית דלתא, בעוד שהפונקציה המקורית עצמה "שואפת" לפונקציה הקבועה $1$.
> אם נחשוב עליה עכשיו בתור ההתמרה, ונבצע לה התמרה הפוכה, אז בגלל שזו פונקציה זוגית, אז כמו בדוגמא הקודמת נקבל ש:
> $$\limfi{M}\frac{1}{2\pi}\int_{-M}^M \frac{\sin(\omega a)}{\omega \pi} \cos(\omega x) \dom = \frac{\chi_{[-a,a]}(x^+)+\chi_{[-a,a]}(x^-)}{2}$$
> שוב נשתמש בכך שהפונקציה באינטגרל היא זוגית, כדי לקבל ש
> $$\frac{1}{\pi}\int_{0}^\infty \frac{\sin(\omega a)}{\omega \pi} \cos(\omega x) \dom = \cases{1&\abs{x}<a\\ \frac{1}{2} & \abs{x}=a \\ 0 & \abs{x}>a}$$

